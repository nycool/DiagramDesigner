<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:at="clr-namespace:DiagramDesigner.AttachedProperties"
    xmlns:c="clr-namespace:DiagramDesigner.Controls"
    xmlns:cmt="clr-namespace:DiagramDesigner.Custom"
    xmlns:cvt="clr-namespace:DiagramDesigner.Converters"
    xmlns:ss="clr-namespace:DiagramDesigner.StyleSelectors">

    <!--  ToolBox  -->
    <Style TargetType="{x:Type cmt:ToolBox}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type cmt:ToolBox}">
                    <Border
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}">
                        <Expander Header="Symbols" IsExpanded="True">
                            <ItemsControl ItemsSource="{TemplateBinding ToolBoxItemsSource}">
                                <ItemsControl.Template>
                                    <ControlTemplate TargetType="{x:Type ItemsControl}">
                                        <Border
                                            Padding="{TemplateBinding Control.Padding}"
                                            Background="{TemplateBinding Panel.Background}"
                                            BorderBrush="{TemplateBinding Border.BorderBrush}"
                                            BorderThickness="{TemplateBinding Border.BorderThickness}"
                                            SnapsToDevicePixels="True">
                                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                                <ItemsPresenter SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
                                            </ScrollViewer>
                                        </Border>
                                    </ControlTemplate>
                                </ItemsControl.Template>
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel
                                            Margin="0,5,0,5"
                                            ItemHeight="50"
                                            ItemWidth="50" />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemContainerStyle>
                                    <Style TargetType="{x:Type ContentPresenter}">
                                        <Setter Property="Control.Padding" Value="10" />
                                        <Setter Property="ContentControl.HorizontalContentAlignment" Value="Stretch" />
                                        <Setter Property="ContentControl.VerticalContentAlignment" Value="Stretch" />
                                        <Setter Property="ToolTip" Value="{Binding ToolTip}" />
                                        <Setter Property="at:DragAndDropProps.EnabledForDrag" Value="True" />
                                    </Style>
                                </ItemsControl.ItemContainerStyle>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Image
                                            Width="50"
                                            Height="50"
                                            IsHitTestVisible="True"
                                            Source="{Binding ImageUrl, Converter={x:Static cvt:ImageUrlCvt.Instance}}"
                                            Stretch="Fill" />
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Expander>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <DrawingBrush
        x:Key="ViewerGridLines"
        TileMode="Tile"
        Viewport="0,0,40,40"
        ViewportUnits="Absolute">
        <DrawingBrush.Drawing>
            <DrawingGroup>
                <DrawingGroup.Children>
                    <GeometryDrawing Geometry="M0,0 L2,0">
                        <GeometryDrawing.Pen>
                            <Pen Brush="Black" Thickness="0.005">
                                <Pen.DashStyle>
                                    <DashStyle Dashes="0.1" />
                                </Pen.DashStyle>
                            </Pen>
                        </GeometryDrawing.Pen>
                    </GeometryDrawing>

                    <GeometryDrawing Geometry="M0,1 L2,1">
                        <GeometryDrawing.Pen>
                            <Pen Brush="Black" Thickness="0.01" />
                        </GeometryDrawing.Pen>
                    </GeometryDrawing>

                    <GeometryDrawing Geometry="M0,0 L0,2">
                        <GeometryDrawing.Pen>
                            <Pen Brush="Black" Thickness="0.005">
                                <Pen.DashStyle>
                                    <DashStyle Dashes="0.1" />
                                </Pen.DashStyle>
                            </Pen>
                        </GeometryDrawing.Pen>
                    </GeometryDrawing>

                    <GeometryDrawing Geometry="M1,0 L1,2">
                        <GeometryDrawing.Pen>
                            <Pen Brush="Black" Thickness="0.01" />
                        </GeometryDrawing.Pen>
                    </GeometryDrawing>
                </DrawingGroup.Children>
            </DrawingGroup>
        </DrawingBrush.Drawing>
    </DrawingBrush>


    <Style TargetType="{x:Type cmt:DiagramView}">
        <Setter Property="Focusable" Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type cmt:DiagramView}">
                    <Border
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}">
                        <Grid>
                            <ScrollViewer
                                Name="DesignerScrollViewer"
                                AllowDrop="True"
                                Background="Transparent"
                                Focusable="True"
                                HorizontalScrollBarVisibility="Auto"
                                VerticalScrollBarVisibility="Auto">
                                <ItemsControl ItemContainerStyleSelector="{x:Static ss:DesignerItemsStyleSelector.Instance}" ItemsSource="{TemplateBinding DiagramItemsSource}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <c:DesignerCanvas
                                                x:Name="Canvas"
                                                MinWidth="1920"
                                                MinHeight="1080"
                                                AllowDrop="True"
                                                Focusable="True">
                                                <c:DesignerCanvas.Style>
                                                    <Style TargetType="{x:Type c:DesignerCanvas}">
                                                        <Setter Property="Background" Value="Gray" />
                                                        <Setter Property="Focusable" Value="True" />
                                                        <Setter Property="AllowDrop" Value="True" />
                                                        <Setter Property="MinWidth" Value="1920" />
                                                        <Setter Property="MinHeight" Value="1080" />
                                                        <Setter Property="ShowGridLines" Value="True" />
                                                        <Setter Property="ContextMenu">
                                                            <Setter.Value>
                                                                <ContextMenu>
                                                                    <MenuItem Command="{x:Static c:DesignerCanvas.BringForward}" Header="up" />
                                                                    <MenuItem Command="{x:Static c:DesignerCanvas.BringToFront}" Header="Front" />
                                                                    <MenuItem Command="{x:Static c:DesignerCanvas.SendBackward}" Header="nex" />
                                                                    <MenuItem Command="{x:Static c:DesignerCanvas.SendToBack}" Header="back" />
                                                                    <MenuItem Command="{x:Static c:DesignerCanvas.AlignTop}" Header="top" />
                                                                    <MenuItem Command="{x:Static c:DesignerCanvas.Group}" Header="group" />
                                                                    <MenuItem Command="{x:Static c:DesignerCanvas.AlignVerticalCenters}" Header="vcenter" />
                                                                    <MenuItem Command="{x:Static c:DesignerCanvas.AlignBottom}" Header="bottom" />
                                                                    <MenuItem Command="{x:Static c:DesignerCanvas.AlignLeft}" Header="left" />
                                                                    <MenuItem Command="{x:Static c:DesignerCanvas.AlignHorizontalCenters}" Header="hc" />
                                                                    <MenuItem Command="{x:Static c:DesignerCanvas.AlignRight}" Header="right" />
                                                                    <MenuItem Command="{x:Static c:DesignerCanvas.DistributeHorizontal}" Header="h" />
                                                                    <MenuItem Command="{x:Static c:DesignerCanvas.DistributeVertical}" Header="v" />
                                                                </ContextMenu>
                                                            </Setter.Value>
                                                        </Setter>

                                                        <Style.Triggers>
                                                            <Trigger Property="ShowGridLines" Value="False">
                                                                <Setter Property="Background" Value="White" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </c:DesignerCanvas.Style>
                                            </c:DesignerCanvas>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </ItemsControl>
                            </ScrollViewer>
                            <c:ZoomBox
                                x:Name="zoomBox"
                                Width="180"
                                Margin="0,5,25,0"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Top"
                                DesignerCanvas="{Binding ElementName=Canvas}"
                                ScrollViewer="{Binding ElementName=DesignerScrollViewer}" />
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>